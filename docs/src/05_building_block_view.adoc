ifndef::imagesdir[:imagesdir: ../images]

[[section-building-block-view]]


== Building Block View

This section describes the static decomposition of the YOVI system into its main building blocks and their dependencies.

=== Whitebox Overall System


_**Context Diagram: YOVI High-Level Components**_
image::05_yovi_System_Architecture.png["YOVI System - Context Diagram (Level 1)", width="600"]

The diagram above illustrates the top-level decomposition of the YOVI system and its external actors (Users and Bots).

Motivation::

The architecture is decomposed based on the core technical requirement to separate the user interface and game management
logic (suited for TypeScript/Web) from the core game rule verification and AI strategy computation (suited for Rust).
This separation aligns with the specified subsystems and promotes modularity, independent scalability, and clear
responsibility boundaries.

Contained Building Blocks::

*   **`yovi_web_app`**: The main web application that provides the user interface, manages game sessions, and handles
user data.
*   **`yovi_game_engine`**: A standalone service responsible for validating game states, determining winners, and
calculating AI moves.

Important Interfaces::

*   **`Game Management API`**: The RESTful interface exposed by the `yovi_web_app` to the `yovi_game_engine` to request
move validation and AI suggestions. This interface uses **YEN notation** over JSON.
*   **`Public Bot API`**: The external RESTful API exposed by the `yovi_web_app` to allow programmatic bots to play the
game.

==== yovi_web_app

*   **Purpose/Responsibility**: Serves as the primary interface for human users and the gateway for external bots. It is
responsible for user management (registration, history), session state, rendering the game UI, and orchestrating calls
to the game engine.
*   **Interface(s)**:
*   **Provided**: Public REST API (`/api/v1/*`) for bots, Web Interface (HTML/JS) for users.
*   **Required**: Consumes the `Game Management API` from the `yovi_game_engine`.
*   **Quality/Performance Characteristics**: Must be highly available and responsive for a good user experience. Stateless
to allow horizontal scaling.
*   **Directory/File Location**: `/web-app/` (Contains React/TypeScript source code).
*   **Fulfilled Requirements**: User registration/history, web frontend, public bot API, strategy selection.
*   **Open Issues/Problems/Risks**: Complexity in managing real-time updates for potential multiplayer features. See
technical risks (Section 11).

==== yovi_game_engine

*   **Purpose/Responsibility**: Encapsulates the definitive rules of Game Y and its variants. Its core functions are to
validate moves, check for a winning condition, and calculate the next move for the AI based on a selected strategy.
*   **Interface(s)**:
*   **Provided**: `Game Management API` (Web Service, e.g., over HTTP). Accepts and returns game states in YEN notation.
*   **Required**: None (it's a terminal building block for core logic).
*   **Quality/Performance Characteristics**: Must have low latency for AI calculations to not hinder gameplay. High
correctness is critical.
*   **Directory/File Location**: `/game-engine/` (Contains Rust source code, Cargo.toml).
*   **Fulfilled Requirements**: Game rule verification, AI move suggestion with multiple strategies.
*   **Open Issues/Problems/Risks**: Performance of complex AI strategies on large boards. Learning curve for Rust .

=== Level 2

Here we detail the internal structure of the two main building blocks.

==== White Box `yovi_web_app`

_**Decomposition of the Web Application**_
image::05_yovi_web_app_Nivel_2.png["White Box: yovi_web_app (Level 2)", width="600"]

The web application is decomposed into four main components:

* **`UI Layer (React Components)`**: Responsible for rendering all user interfaces, including the game board, user
dashboard, and registration forms.Implements i18n and responsive design (aligned with ADR 1 & 2).
* **`API Client & State Manager`**: Manages the application state (e.g., current game, user info) and handles all
communication with the backend `Game Management API`.Transforms data between frontend models and YEN notation.
* **`Public API Router`**: Implements and exposes the external `Public Bot API`.It authenticates requests, manages
bot sessions, and translates between the public API calls and internal application logic.
* **`User & Session Service`**: Handles business logic for user authentication, registration, and persistence/retrieval
of game history and statistics.

[#_white_box_yovi_game_engine]
==== White Box `yovi_game_engine`
_**Decomposition of the Game Engine**_
image::05_yovi_game_engine_Nivel_2.png["White Box: yovi_game_engine (Level 2)", width="600"]

The game engine is decomposed into three logical components:

* **`YEN Parser & Validator`**: Responsible for parsing incoming YEN JSON, validating its syntactic and semantic
correctness against the current board rules, and serializing outgoing YEN states.
* **`Game Rules Core`**: The single source of truth for all Game Y variants.Contains the logic for board representation,
move application, and win condition checking.
* **`AI Strategy Module`**: Implements the pluggable strategy pattern (aligned with ADR 4).Contains different algorithms
(e.g., Minimax, Random) and difficulty levels that can be selected via the API request.